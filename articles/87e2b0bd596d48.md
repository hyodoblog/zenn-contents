---
title: "Stripe Taxä½¿ç”¨æ™‚ã€Apple Payãƒ»Google Payã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•"
emoji: "ğŸ’"
type: "tech"
topics:
  - "stripe"
published: true
published_at: "2022-12-07 16:45"
---

ã“ã®è¨˜äº‹ã¯ã€[JP_Stripes Advent Calendar 2022](https://adventar.org/calendars/7823) 7æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

ã¨ã‚ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§Stripeã‚’ä½¿ã£ãŸæœˆé¡ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ—ãƒªã‚’ä½œã‚Šã¾ã—ãŸãŒã€é–‹ç™ºæ™‚Appleã€€Payã¨Google Pay(ä»¥ä¸‹é›»å­æ±ºæ¸ˆã¨å‘¼ã¶)ãŒè¡¨ç¤ºã•ã‚Œãªã„ç¾è±¡ãŒã‚ã‚Šã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/152c61fb7245-20221002.png =300x)

æœ¬æ¥ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/f509f03ccd7d-20221206.jpg =300x)

é›»å­æ±ºæ¸ˆã¯åŸºæœ¬è‡ªå‹•ã§æœ‰åŠ¹åŒ–ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€Stripeãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ä¸Šã®è¨­å®šä¸è¶³ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚


# åŸå› 

è‰²ã€…èª¿æŸ»ã—ãŸçµæœã€Checkout URLã‚’ç”Ÿæˆã™ã‚‹éš›ã®è¨­å®šãŒåŸå› ã ã¨åˆ¤æ˜ã—ã¾ã—ãŸã€‚

ä»¥ä¸‹ã¯Checkoutä½œæˆæ™‚ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚

```typescript
const { url } = await stripe.checkout.sessions.create({
  customer: "STRIPE_CUSTOMER_ID",
  customer_update: {
    address: 'auto'
  },
  automatic_tax: {
    enabled: true
  },
  line_items: [
    {
      price: "STRIPE_PRICE_ID",
      quantity: 1
    }
  ],
  mode: 'subscription',
  payment_method_types: ['card'],
  success_url: "SUCCESS_URL",
  cancel_url: "CANCEL_URL"
})
```

å•é¡Œã®ç®‡æ‰€ã¯`automatic_tax`ã§ã€æœ€è¿‘ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§è¿½åŠ ã•ã‚ŒãŸStripeã®ç¨é‡‘è‡ªå‹•è¨ˆç®—è¨­å®šã§å®Ÿè£…ã—ã¦ãŠã‚Šã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/025380661dd2-20221002.png)

ãŠãã‚‰ãStripeã®å…¬å¼FAQã‚µã‚¤ãƒˆã«ã‚‚è¨˜è¼‰ã•ã‚Œã¦ã‚‹ã‚ˆã†ã«ã€ä½æ‰€ã®å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚ªãƒ•ã«ã—ã¦ã„ã‚‹ãŸã‚è¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸã®ã ã¨æ¨æ¸¬ã—ã¦ã¾ã™ã€‚

https://stripe.com/docs/tax/faq#stripe-tax-%E3%81%A7-apple-pay-%E3%81%A8-google-pay-%E3%82%92%E5%88%A9%E7%94%A8%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%81%8B%EF%BC%9F

ä¾¿åˆ©ãªæ©Ÿèƒ½ã ã£ãŸã®ã§è‡ªå‹•è¨­å®šã‚’æ¡ç”¨ã—ãŸã‹ã£ãŸã®ã§ã™ãŒã€ä½æ‰€å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§è§£ç´„ç‡ãŒä¸‹ãŒã‚‹ã¨äºˆæƒ³ã—ãŸãŸã‚ä»Šå›ã¯åˆ¥ã®è§£æ±ºç­–ã«ã—ã¾ã—ãŸã€‚


# è§£æ±ºæ–¹æ³•

è‡ªå‹•ã§ã¯ãªãã€æ‰‹å‹•ã§ä½œã‚‹ã“ã¨ã§è§£æ±ºã—ã¾ã—ãŸã€‚

æ—§å¼ã®ã‚„ã‚Šæ–¹ã§ã€Stripeã®ç¨é‡‘è¨­å®šã§ã€ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã€å›½ã‚’è¨­å®šã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«`tax_id`ãŒç™ºè¡Œã•ã‚Œã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/53037c33e465-20221207.png)

```typescript
const { url } = await stripe.checkout.sessions.create({
  customer: "STRIPE_CUSTOMER_ID",
  line_items: [
    {
      price: "STRIPE_PRICE_ID",
      quantity: 1,
      tax_rates: ["STRIPE_TAX_ID"]
    }
  ],
  mode: 'subscription',
  payment_method_types: ['card'],
  success_url: "SUCCESS_URL",
  cancel_url: "CANCEL_URL"
})
```

å…ˆç¨‹ã®`tax_id`ã‚’`line_items`å†…ã®`tax_rates`å†…ã«é…åˆ—å½¢å¼ã§æ¸¡ã›ã°å®Œäº†ã§ã™ã€‚

ã“ã‚Œã§å•é¡Œãªãè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/1ca4dd81be81-20221207.pngã€€=300x)

![](https://storage.googleapis.com/zenn-user-upload/831fbc8bfe1e-20221207.png =300x)

**æœ¬å½“ã¯è‡ªå‹•ã§è¨­å®šã—ãŸã‹ã£ãŸã®ã§ã™ãŒã€è§£æ±ºç­–ãŒã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§çŸ¥è¦‹ã‚’ãŠæŒã¡ã®æ–¹ãŒãŠã‚‰ã‚Œã¾ã—ãŸã‚‰ãœã²ã‚³ãƒ¡ãƒ³ãƒˆã®æ–¹ã«ãŠé¡˜ã„ã—ã¾ã™ã€‚**